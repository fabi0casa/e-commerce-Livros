<!DOCTYPE html>
<html lang="pt-BR" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" href="../../icon.png">
    <title>Listagem de Clientes</title>
    <link rel="stylesheet" href="../css/menuAdmin.css">
</head>
<body>
	<header>
			<a th:href="@{/administrador/admin}"><img src="/img//home.png" alt="home" class="header-logo"></a>
			Página do Administrador
	</header>
    <a th:href ="@{/administrador/gerenciar-clientes/cadastrarCliente}"><button class="new-client">Cadastrar Novo Cliente</button></a>
    <div class="container">
        <h2>Gerenciamento de Clientes</h2>
        <div class="filters">
            <input type="text" placeholder="Nome do Cliente">
            <input type="email" placeholder="Email">
            <input type="tel" placeholder="Telefone">
            <input type="text" placeholder="CPF">
            <input type="text" placeholder="Data de Nascimento">
            <input type="text" placeholder="Gênero">
            <input type="text" placeholder="Endereço">
        </div>
        <div class="filters">
            <button>Pesquisar</button>
        </div>

        <p th:if="${clientes == null}" style="color: red;">Erro: Nenhum dado de cliente foi carregado.</p>
        <p th:if="${clientes != null and #lists.isEmpty(clientes)}" style="color: orange;">Nenhum cliente cadastrado.</p>
        <p th:if="${clientes != null and not #lists.isEmpty(clientes)}" th:text="|${#lists.size(clientes)} clientes carregados.|"></p>

        <div class="client-list">
            <div class="client-item" th:each="cliente : ${clientes}">
                <div class="client-info">
                    <div class="client-name" th:text="${cliente.nome}"></div>
                    <div class="client-details" th:text="|${cliente.email} - ${cliente.telefone} - ${cliente.dataNascimento}|"></div>
                </div>
                <div class="client-actions">
                    <button onclick="openClientModal(this)" th:data-nome="${cliente.nome}" 
                        th:data-email="${cliente.email}" 
                        th:data-telefone="${cliente.telefone}" 
                        th:data-nascimento="${cliente.dataNascimento}" 
                        th:data-genero="${cliente.genero}" 
                        th:data-cpf="${cliente.cpf}" 
                        th:data-ranking="${cliente.ranking}">
                        Ver
                    </button>

                    <button onclick="openModal('editionModal')">Editar</button>
                    <button onclick="openModal('confirmModal')">Inativar</button>
                    <button onclick="redirecioarAoTransacoes()">Ver Transações</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Popups (Modais) -->
    <!-- Modal Principal -->
    <div id="clientModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeModal('clientModal')">&times;</span>
            <h2>Detalhes do Cliente</h2>
            <p><strong>Nome:</strong> <span id="modalNome"></span></p>
            <p><strong>Email:</strong> <span id="modalEmail"></span></p>
            <p><strong>Telefone:</strong> <span id="modalTelefone"></span></p>
            <p><strong>Data de Nascimento:</strong> <span id="modalNascimento"></span></p>
            <p><strong>Gênero:</strong> <span id="modalGenero"></span></p>
            <p><strong>CPF:</strong> <span id="modalCpf"></span></p>
            <p><strong>Ranking:</strong> <span id="modalRanking"></span></p>
            <button onclick="openModal('addressModal')">Ver Endereços</button>
            <button onclick="openModal('cardModal')">Ver Cartões</button>
        </div>
    </div>
    

    <!-- Modal de Endereços -->
    <div id="addressModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeModal('addressModal')">&times;</span>
            <h2>Endereços Cadastrados</h2>

            <button class="accordion">Rua Exemplo, 123 - São Paulo, SP</button>
            <div class="panel">
                <p><strong>Tipo:</strong> Apartamento</p>
                <p><strong>Logradouro:</strong> Rua Exemplo</p>
                <p><strong>Número:</strong> 123</p>
                <p><strong>Bairro:</strong> Centro</p>
                <p><strong>CEP:</strong> 01000-000</p>
                <p><strong>Cidade:</strong> São Paulo</p>
                <p><strong>Estado:</strong> SP</p>
                <p><strong>País:</strong> Brasil</p>
                <p><strong>Observação:</strong> Próximo ao metrô</p>
            </div>

            <button class="accordion">Av. Teste, 456 - Rio de Janeiro, RJ</button>
            <div class="panel">
                <p><strong>Tipo:</strong> Casa</p>
                <p><strong>Logradouro:</strong> Av. Teste</p>
                <p><strong>Número:</strong> 456</p>
                <p><strong>Bairro:</strong> Copacabana</p>
                <p><strong>CEP:</strong> 22000-000</p>
                <p><strong>Cidade:</strong> Rio de Janeiro</p>
                <p><strong>Estado:</strong> RJ</p>
                <p><strong>País:</strong> Brasil</p>
                <p><strong>Observação:</strong> Casa de Praia</p>
            </div>
        </div>
    </div>

    <!-- Modal de Cartões -->
    <div id="cardModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeModal('cardModal')">&times;</span>
            <h2>Cartões Cadastrados</h2>

            <button class="accordion">**** **** **** 1234</button>
            <div class="panel">
                <p><strong>Nome Impresso:</strong> João Silva</p>
                <p><strong>Bandeira:</strong> Visa</p>
                <p><strong>Código de Segurança:</strong> 123</p>
                <p><strong>Preferencial:</strong> Sim</p>
            </div>

            <button class="accordion">**** **** **** 5678</button>
            <div class="panel">
                <p><strong>Nome Impresso:</strong> João Silva</p>
                <p><strong>Bandeira:</strong> MasterCard</p>
                <p><strong>Código de Segurança:</strong> 456</p>
                <p><strong>Preferencial:</strong> Não</p>
            </div>
        </div>
    </div>
    <!-- Modal de Confirmação para Inativação -->
    <div id="confirmModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeModal('confirmModal')">&times;</span>
            <h2>Aviso!</h2>
            <p>Deseja mesmo inativar o cliente "João Silva"?</p>
            <button>Inativar Cliente</button>
            <button onclick="closeModal('confirmModal')">Cancelar</button>
        </div>
    </div>
    <!-- Modal da edição do cliente-->
    <div id="editionModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeModal('editionModal')">&times;</span>
            <h2>Qual operação de edição deseja realizar?</h2>
            <a th:href="@{/administrador/gerenciar-clientes/editarCliente}"><button>Editar Dados do Cliente</button></a>
            <a th:href="@{/administrador/gerenciar-clientes/alterarSenha}"><button>Alterar a Senha do Cliente</button></a>
            <a th:href="@{/administrador/gerenciar-clientes/listarEndereco}"><button>Editar Endereços</button></a>
            <a th:href="@{/administrador/gerenciar-clientes/cadastrarCartao}"><button>Cadastrar Novo Cartão</button></a>
        </div>
    </div>

    <script>
        function openModal(modalId) {
            document.getElementById(modalId).style.display = "flex";
        }

        function closeModal(modalId) {
            document.getElementById(modalId).style.display = "none";
        }
        // Script para o efeito de accordion (lingueta que desce)
        document.addEventListener("DOMContentLoaded", function () {
            let accordions = document.querySelectorAll(".accordion");

            accordions.forEach(button => {
                button.addEventListener("click", function () {
                    let panel = this.nextElementSibling;
                    if (panel.style.display === "block") {
                        panel.style.display = "none";
                    } else {
                        panel.style.display = "block";
                    }
                });
            });
        });

        function redirecioarAoTransacoes(){
            window.location.href = "/administrador/gerenciar-clientes/transacoes";
        }

        function openClientModal(button) {
            document.getElementById("modalNome").textContent = button.getAttribute("data-nome");
            document.getElementById("modalEmail").textContent = button.getAttribute("data-email");
            document.getElementById("modalTelefone").textContent = button.getAttribute("data-telefone");
            document.getElementById("modalNascimento").textContent = button.getAttribute("data-nascimento");
            document.getElementById("modalGenero").textContent = button.getAttribute("data-genero");
            document.getElementById("modalCpf").textContent = button.getAttribute("data-cpf");
            document.getElementById("modalRanking").textContent = button.getAttribute("data-ranking");

            openModal('clientModal');
        }
        
    </script>
</body>
</html>
